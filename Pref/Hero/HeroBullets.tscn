[gd_scene load_steps=2 format=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

export (PackedScene) var bullet
var pool = Array()

#---------------------------------------------------------------
func fire(bullet_node, bullet_position, direction):
	if pool.empty():
		create_new_bullet(bullet_node, bullet_position, direction)
	else:
		find_free(bullet_node, bullet_position, direction)

func find_free(bullet_node, bullet_position, direction):
	var count = pool.size()
	for b in pool:
		if !b.visible:
			b.visible = true
			b.direction = direction
			b.position = bullet_position
			b.position.y += 3
			if direction > 0:
				b.position.x += 16
			return
		else:
			count -= 1
	if count == 0:
		create_new_bullet(bullet_node, bullet_position, direction)

func create_new_bullet(bullet_node, bullet_position, direction):
	var b = bullet_node.instance()
	b.direction = direction
	b.position = bullet_position
	b.position.y += 3
	if direction > 0:
		b.position.x += 16
	add_child(b)
	pool.append(b)
"

[node name="HeroBullets" type="Node2D"]
script = SubResource( 1 )
